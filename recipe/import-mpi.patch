From 6b14f2a8164fdbd3492b49055557983096f25b81 Mon Sep 17 00:00:00 2001
From: Min RK <benjaminrk@gmail.com>
Date: Thu, 2 Nov 2023 09:20:49 +0100
Subject: [PATCH] make sure mpi, petsc are initialized at import

avoids potential crashes
---
 python/dolfinx_mpc/__init__.py | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/python/dolfinx_mpc/__init__.py b/python/dolfinx_mpc/__init__.py
index 573d218..82effd7 100644
--- a/python/dolfinx_mpc/__init__.py
+++ b/python/dolfinx_mpc/__init__.py
@@ -8,6 +8,14 @@
 # flake8: noqa
 from __future__ import annotations
 
+# make sure MPI, PETSc are initialized
+# before they are used
+from mpi4py import MPI
+from petsc4py import PETSc
+
+# don't pollute the namespace
+del MPI, PETSc
+
 import dolfinx_mpc.cpp
 
 # New local assemblies
-- 
2.42.0

